% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot_coassignment.R
\name{plot_coassignment}
\alias{plot_coassignment}
\title{Plot Co-assignment Probability Heatmap}
\usage{
plot_coassignment(
  coassign_matrix,
  cluster_rows = FALSE,
  cluster_cols = FALSE,
  title = "Co-assignment Probabilities",
  color = rev(viridis::magma(100)),
  display_numbers = FALSE,
  number_format = "\%.2f",
  ...
)
}
\arguments{
\item{coassign_matrix}{A numeric matrix of co-assignment probabilities,
as returned by \code{\link{bootstrap_clusters}}.}

\item{cluster_rows}{Logical. Whether to hierarchically cluster the rows.
Default is \code{FALSE} to preserve original cluster ordering.}

\item{cluster_cols}{Logical. Whether to hierarchically cluster the columns.
Default is \code{FALSE}.}

\item{title}{Character string for the heatmap title. Default is
\code{"Co-assignment Probabilities"}.}

\item{color}{Color palette vector. Default uses \code{viridis::magma(100)}
reversed.}

\item{display_numbers}{Logical. If \code{TRUE}, displays probability values
in each cell. Default is \code{FALSE}.}

\item{number_format}{Character string for \code{sprintf} formatting of
displayed numbers. Default is \code{"\%.2f"}.}

\item{...}{Additional arguments passed to \code{pheatmap::pheatmap}.}
}
\value{
Invisibly returns the pheatmap object.
}
\description{
Visualizes the co-assignment probability matrix as a heatmap using
\code{pheatmap}. Diagonal values represent cluster self-stability.
Off-diagonal values indicate the degree of overlap between cluster pairs.
}
\examples{
\dontrun{
coassign <- bootstrap_clusters(seurat_obj, reduction = "pca")
plot_coassignment(coassign)

# With numbers displayed and custom title
plot_coassignment(coassign, display_numbers = TRUE,
                  title = "My Dataset - Cluster Stability")

# With hierarchical clustering of rows/columns
plot_coassignment(coassign, cluster_rows = TRUE, cluster_cols = TRUE)
}

}
